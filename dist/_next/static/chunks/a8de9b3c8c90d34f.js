(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,44636,e=>{"use strict";var t=e.i(43476),r=e.i(71645);let n=(0,r.createContext)(void 0),a="kyr-theme-preference";function o({children:e}){let[o,s]=(0,r.useState)("dark"),[i,l]=(0,r.useState)(!1);(0,r.useEffect)(()=>{l(!0);let e=localStorage.getItem(a);if(e)s(e),document.documentElement.setAttribute("data-theme",e);else{let e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";s(e),document.documentElement.setAttribute("data-theme",e)}},[]);let c=e=>{s(e),localStorage.setItem(a,e),document.documentElement.setAttribute("data-theme",e)};return(0,t.jsx)(n.Provider,{value:{theme:o,toggleTheme:()=>{c("dark"===o?"light":"dark")},setTheme:c},children:i?e:(0,t.jsx)("div",{style:{visibility:"hidden"},children:e})})}function s(){let e=(0,r.useContext)(n);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}e.s(["ThemeProvider",()=>o,"useTheme",()=>s])},2971,e=>{"use strict";var t=e.i(43476),r=e.i(22016),n=e.i(44636),a=e.i(71645),o=e.i(75681);function s(){let{theme:e,toggleTheme:o}=(0,n.useTheme)(),[s,l]=(0,a.useState)(!1),[c,d]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let e=()=>{l(window.scrollY>10)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),(0,a.useEffect)(()=>{let e=e=>{let t=e.target;c&&!t.closest(".mobile-menu-container")&&d(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[c]),(0,a.useEffect)(()=>(c?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[c]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("header",{className:`sticky top-0 z-40 transition-all duration-300 ${s?"glass border-b border-[var(--card-border)] shadow-lg":"bg-transparent"}`,role:"banner",children:[(0,t.jsx)("div",{className:"progress-bar-container fixed top-0 left-0 right-0 z-50",children:(0,t.jsx)(i,{})}),(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,t.jsxs)(r.default,{href:"/",className:"flex items-center gap-3 group",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-[var(--accent)] to-[var(--accent-dark)] flex items-center justify-center shadow-lg shadow-[var(--accent)]/20 group-hover:shadow-[var(--accent)]/40 transition-shadow duration-300",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),(0,t.jsx)("div",{className:"absolute inset-0 w-10 h-10 rounded-xl bg-[var(--accent)] blur-xl opacity-0 group-hover:opacity-50 transition-opacity duration-300"})]}),(0,t.jsx)("span",{className:"text-lg font-bold gradient-text hidden sm:block",children:"Know Your Rights"}),(0,t.jsx)("span",{className:"text-lg font-bold gradient-text sm:hidden",children:"KYR"})]}),(0,t.jsxs)("nav",{className:"hidden sm:flex items-center gap-1","aria-label":"Main navigation",children:[(0,t.jsx)(r.default,{href:"/",className:"px-4 py-2 rounded-lg text-sm font-medium text-[var(--muted)] hover:text-[var(--foreground)] hover:bg-[var(--card-bg)] transition-all duration-200",children:"Home"}),(0,t.jsx)(r.default,{href:"/quiz",className:"px-4 py-2 rounded-lg text-sm font-medium text-[var(--muted)] hover:text-[var(--foreground)] hover:bg-[var(--card-bg)] transition-all duration-200",children:"Quiz"}),(0,t.jsx)(r.default,{href:"/saved",className:"px-4 py-2 rounded-lg text-sm font-medium text-[var(--muted)] hover:text-[var(--foreground)] hover:bg-[var(--card-bg)] transition-all duration-200",children:"Saved"}),(0,t.jsx)(r.default,{href:"/emergency",className:"px-4 py-2 rounded-lg text-sm font-medium text-[var(--danger)] hover:bg-[var(--danger)]/10 transition-all duration-200",children:"Emergency"}),(0,t.jsx)("button",{onClick:o,className:"theme-toggle p-2 rounded-lg text-[var(--muted)] hover:text-[var(--foreground)] hover:bg-[var(--card-bg)] transition-all duration-200 ml-2","aria-label":"dark"===e?"Switch to light mode":"Switch to dark mode",title:"dark"===e?"Switch to light mode":"Switch to dark mode",children:"dark"===e?(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})})]}),(0,t.jsx)("button",{className:"sm:hidden p-2 rounded-lg text-[var(--muted)] hover:text-[var(--foreground)] hover:bg-[var(--card-bg)] transition-colors mobile-menu-container","aria-label":c?"Close menu":"Open menu","aria-expanded":c,onClick:()=>d(!c),children:c?(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}):(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})})]}),(0,t.jsx)("div",{className:`fixed inset-0 z-30 bg-black/50 backdrop-blur-sm transition-opacity duration-300 sm:hidden ${c?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:()=>d(!1),"aria-hidden":"true"}),(0,t.jsx)("div",{className:`fixed top-0 right-0 h-full w-72 max-w-[80vw] bg-[var(--card-bg)] border-l border-[var(--card-border)] z-40 transform transition-transform duration-300 ease-out sm:hidden mobile-menu-container ${c?"translate-x-0":"translate-x-full"}`,role:"dialog","aria-label":"Mobile navigation","aria-modal":"true",children:(0,t.jsx)("div",{className:"p-6 pt-20",children:(0,t.jsxs)("nav",{className:"flex flex-col gap-2","aria-label":"Mobile navigation",children:[(0,t.jsxs)(r.default,{href:"/",className:"flex items-center gap-3 px-4 py-3 rounded-xl text-[var(--foreground)] hover:bg-[var(--accent)]/10 transition-colors",onClick:()=>d(!1),children:[(0,t.jsx)("svg",{className:"w-5 h-5 text-[var(--accent)]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Home"]}),(0,t.jsxs)(r.default,{href:"/quiz",className:"flex items-center gap-3 px-4 py-3 rounded-xl text-[var(--foreground)] hover:bg-[var(--accent)]/10 transition-colors",onClick:()=>d(!1),children:[(0,t.jsx)("svg",{className:"w-5 h-5 text-[var(--accent)]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Quiz"]}),(0,t.jsxs)(r.default,{href:"/saved",className:"flex items-center gap-3 px-4 py-3 rounded-xl text-[var(--foreground)] hover:bg-[var(--accent)]/10 transition-colors",onClick:()=>d(!1),children:[(0,t.jsx)("svg",{className:"w-5 h-5 text-[var(--accent)]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})}),"Saved Rights"]}),(0,t.jsxs)(r.default,{href:"/emergency",className:"flex items-center gap-3 px-4 py-3 rounded-xl text-[var(--danger)] hover:bg-[var(--danger)]/10 transition-colors",onClick:()=>d(!1),children:[(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Emergency"]}),(0,t.jsx)("div",{className:"border-t border-[var(--card-border)] my-2"}),(0,t.jsx)("button",{onClick:()=>{o(),d(!1)},className:"flex items-center gap-3 px-4 py-3 rounded-xl text-[var(--foreground)] hover:bg-[var(--accent)]/10 transition-colors text-left",children:"dark"===e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("svg",{className:"w-5 h-5 text-[var(--accent)]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),"Switch to Light Mode"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("svg",{className:"w-5 h-5 text-[var(--accent)]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),"Switch to Dark Mode"]})}),(0,t.jsxs)(r.default,{href:"/pocket-card",className:"flex items-center gap-3 px-4 py-3 rounded-xl text-[var(--foreground)] hover:bg-[var(--accent)]/10 transition-colors",onClick:()=>d(!1),children:[(0,t.jsx)("svg",{className:"w-5 h-5 text-[var(--accent)]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Pocket Card"]})]})})})]})}function i(){let[e,r]=(0,a.useState)(0),[n,s]=(0,a.useState)(0),[i,l]=(0,a.useState)(0);return((0,a.useEffect)(()=>{let e=o.default.scenarios;l(e.length);let t=JSON.parse(localStorage.getItem("kyr-viewed-scenarios")||"[]");s(t.length),r(t.length/e.length*100)},[]),(0,a.useEffect)(()=>{let e=()=>{let e=o.default.scenarios;l(e.length);let t=JSON.parse(localStorage.getItem("kyr-viewed-scenarios")||"[]");s(t.length),r(t.length/e.length*100)};return window.addEventListener("storage",e),window.addEventListener("kyr-progress-update",e),()=>{window.removeEventListener("storage",e),window.removeEventListener("kyr-progress-update",e)}},[]),0===e)?null:(0,t.jsx)("div",{className:"progress-bar",style:{"--progress":`${e}%`},role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":i,"aria-label":`Progress: ${n} of ${i} scenarios viewed`})}e.s(["default",()=>s],2971)},3749,e=>{"use strict";var t=e.i(43476),r=e.i(22016),n=e.i(71645);function a({scenario:e,index:a}){let[o,s]=(0,n.useState)(!1),[i,l]=(0,n.useState)(!1),c=(0,n.useRef)(null);return(0,n.useEffect)(()=>{s(JSON.parse(localStorage.getItem("kyr-viewed-scenarios")||"[]").includes(e.id));let t=()=>{s(JSON.parse(localStorage.getItem("kyr-viewed-scenarios")||"[]").includes(e.id))};return window.addEventListener("kyr-progress-update",t),()=>window.removeEventListener("kyr-progress-update",t)},[e.id]),(0,n.useEffect)(()=>{let e=c.current;if(!e||i)return;let t=new IntersectionObserver(([e])=>{e.isIntersecting&&(l(!0),t.disconnect())},{threshold:.15});return t.observe(e),()=>t.disconnect()},[i]),(0,t.jsx)(r.default,{ref:c,href:`/scenario/${e.id}`,className:`group relative block card-focus card-entrance ${i?"visible":""}`,style:{transitionDelay:`${100*a}ms`},"aria-label":`${e.title} - ${e.category}. ${o?"Viewed":"Not viewed"}`,children:(0,t.jsxs)("div",{className:"relative overflow-hidden rounded-2xl bg-[var(--card-bg)] border border-[var(--card-border)] p-6 h-full card-neon-hover",children:[(0,t.jsx)("div",{className:"absolute -inset-[1px] rounded-2xl bg-gradient-to-br from-indigo-500/25 via-purple-500/15 to-blue-500/25 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"}),(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-[var(--accent)]/5 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"}),(0,t.jsxs)("div",{className:"relative z-10",children:[o&&(0,t.jsx)("div",{className:"absolute top-0 right-0 z-10",children:(0,t.jsxs)("div",{className:"bg-[var(--success)]/90 text-white text-[10px] font-bold px-3 py-1 rounded-bl-lg flex items-center gap-1",children:[(0,t.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Viewed"]})}),(0,t.jsxs)("div",{className:"relative mb-4",children:[(0,t.jsx)("div",{className:"scenario-card-icon w-14 h-14 rounded-xl bg-gradient-to-br from-[var(--accent)]/20 to-[var(--accent)]/5 flex items-center justify-center text-3xl border border-[var(--accent)]/20 group-hover:scale-110 group-hover:rotate-3 transition-transform duration-300",children:e.icon}),(0,t.jsx)("div",{className:"absolute inset-0 w-14 h-14 rounded-xl bg-[var(--accent)]/20 blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),(0,t.jsx)("span",{className:"relative inline-block text-xs font-medium text-[var(--accent-light)] bg-[var(--accent)]/10 px-3 py-1 rounded-full mb-3",children:e.category}),(0,t.jsx)("h3",{className:"relative text-lg font-bold text-[var(--foreground)] mb-2 group-hover:text-[var(--accent-light)] transition-colors duration-300",children:e.title}),(0,t.jsx)("p",{className:"relative text-sm text-[var(--muted)] line-clamp-2",children:e.description}),(0,t.jsxs)("div",{className:"relative mt-4 flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"text-xs text-[var(--muted)]",children:[e.rights.length," rights"]}),(0,t.jsxs)("div",{className:"flex items-center text-sm font-medium text-[var(--accent)] opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-x-[-10px] group-hover:translate-x-0",children:[(0,t.jsx)("span",{children:"Learn"}),(0,t.jsx)("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})]})})}e.s(["default",()=>a])},43343,e=>{"use strict";var t=e.i(43476),r=e.i(71645);function n({selectedState:e,onStateChange:n,availableStates:a}){let[o,s]=(0,r.useState)(!1),[i,l]=(0,r.useState)(-1),c=(0,r.useRef)(null),d=(0,r.useRef)(null),u=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=e=>{c.current&&!c.current.contains(e.target)&&s(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let h=(0,r.useCallback)(t=>{if(!o){("Enter"===t.key||" "===t.key||"ArrowDown"===t.key)&&(t.preventDefault(),s(!0),l(e?a.indexOf(e)+1:0));return}let r=["",...a];switch(t.key){case"ArrowDown":t.preventDefault(),l(e=>(e+1)%r.length);break;case"ArrowUp":t.preventDefault(),l(e=>(e-1+r.length)%r.length);break;case"Enter":t.preventDefault(),i>=0&&f(r[i]);break;case"Escape":t.preventDefault(),s(!1),d.current?.focus();break;case"Tab":s(!1);break;case"Home":t.preventDefault(),l(0);break;case"End":t.preventDefault(),l(r.length-1)}},[o,i,a,e]);(0,r.useEffect)(()=>{if(o&&i>=0&&u.current){let e=u.current.querySelectorAll("button")[i];e&&e.scrollIntoView({block:"nearest"})}},[i,o]);let f=e=>{n(e),s(!1),d.current?.focus()};return(0,t.jsxs)("div",{className:"relative",ref:c,children:[(0,t.jsxs)("button",{ref:d,onClick:()=>{s(!o),o||l(e?a.indexOf(e)+1:0)},onKeyDown:h,className:`flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-medium transition-all duration-300 ${e?"bg-[var(--success)]/20 text-[var(--success)] border border-[var(--success)]/30":"bg-[var(--card-bg)] text-[var(--foreground)] border border-[var(--card-border)] hover:border-[var(--accent)]/50"}`,"aria-haspopup":"listbox","aria-expanded":o,"aria-label":e?`Selected state: ${e}. Change state`:"Select a state",children:[(0,t.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,t.jsx)("span",{children:e||"Select State"}),(0,t.jsx)("svg",{className:`w-4 h-4 transition-transform duration-200 ${o?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,t.jsx)("div",{className:`absolute z-50 mt-2 w-48 rounded-xl bg-[var(--card-bg)] border border-[var(--card-border)] shadow-xl shadow-black/20 overflow-hidden transition-all duration-200 ${o?"opacity-100 translate-y-0 pointer-events-auto":"opacity-0 -translate-y-2 pointer-events-none"}`,role:"listbox","aria-label":"Select a state",children:(0,t.jsxs)("div",{ref:u,className:"max-h-60 overflow-y-auto",role:"presentation",children:[(0,t.jsx)("button",{onClick:()=>f(""),onMouseEnter:()=>l(0),className:`w-full text-left px-4 py-3 text-sm transition-colors duration-150 ${""===e?"bg-[var(--accent)]/20 text-[var(--accent-light)]":0===i?"bg-[var(--accent)]/10 text-[var(--foreground)]":"text-[var(--foreground)] hover:bg-[var(--card-border)]"}`,role:"option","aria-selected":""===e,tabIndex:-1,children:"All States (General)"}),a.map((r,n)=>{let a=n+1;return(0,t.jsx)("button",{onClick:()=>f(r),onMouseEnter:()=>l(a),className:`w-full text-left px-4 py-3 text-sm transition-colors duration-150 ${e===r?"bg-[var(--accent)]/20 text-[var(--accent-light)]":i===a?"bg-[var(--accent)]/10 text-[var(--foreground)]":"text-[var(--foreground)] hover:bg-[var(--card-border)]"}`,role:"option","aria-selected":e===r,tabIndex:-1,children:r},r)})]})})]})}e.s(["default",()=>n])},5903,e=>{"use strict";var t=e.i(43476),r=e.i(71645),n=e.i(22016);function a({scenarios:e}){let[a,o]=(0,r.useState)(""),[s,i]=(0,r.useState)([]),[l,c]=(0,r.useState)(!1),d=(0,r.useRef)(null),u=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=e=>{u.current&&!u.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,r.useEffect)(()=>{if(a.length<2){i([]),c(!1);return}let t=a.toLowerCase(),r=[];e.forEach(e=>{(e.title.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.category.toLowerCase().includes(t))&&r.push({scenario:e}),e.rights.forEach(n=>{(n.title.toLowerCase().includes(t)||n.description.toLowerCase().includes(t)||n.source.toLowerCase().includes(t))&&r.push({scenario:e,right:{title:n.title,description:n.description}})})});let n=r.filter((e,t,r)=>t===r.findIndex(t=>t.scenario.id===e.scenario.id&&t.right?.title===e.right?.title)).slice(0,6);i(n),c(n.length>0)},[a,e]),(0,t.jsxs)("div",{className:"relative w-full max-w-md",ref:u,children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("svg",{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[var(--muted)]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),(0,t.jsx)("input",{ref:d,type:"text",placeholder:"Search rights, scenarios...",value:a,onChange:e=>o(e.target.value),className:"w-full pl-12 pr-10 py-3 rounded-xl bg-[var(--card-bg)] border border-[var(--card-border)] text-[var(--foreground)] placeholder-[var(--muted)] focus:outline-none focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20 transition-all duration-200"}),a&&(0,t.jsx)("button",{onClick:()=>{o(""),i([]),c(!1),d.current?.focus()},className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-6 h-6 rounded-full bg-[var(--card-border)] flex items-center justify-center text-[var(--muted)] hover:text-[var(--foreground)] transition-colors",children:(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l&&(0,t.jsxs)("div",{className:"absolute z-50 mt-2 w-full rounded-xl bg-[var(--card-bg)] border border-[var(--card-border)] shadow-xl shadow-black/20 overflow-hidden animate-fade-in",children:[(0,t.jsx)("div",{className:"max-h-80 overflow-y-auto py-2",children:s.map((e,r)=>(0,t.jsxs)(n.default,{href:`/scenario/${e.scenario.id}`,onClick:()=>{c(!1),o("")},className:"flex items-start gap-3 px-4 py-3 hover:bg-[var(--card-border)] transition-colors",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-lg bg-[var(--accent)]/10 flex items-center justify-center text-xl",children:e.scenario.icon}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-[var(--foreground)] truncate",children:e.scenario.title}),e.right?(0,t.jsx)("p",{className:"text-xs text-[var(--accent-light)] mt-0.5",children:e.right.title}):(0,t.jsx)("p",{className:"text-xs text-[var(--muted)] mt-0.5 line-clamp-1",children:e.scenario.description})]}),(0,t.jsx)("svg",{className:"flex-shrink-0 w-4 h-4 text-[var(--muted)] mt-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]},`${e.scenario.id}-${r}`))}),(0,t.jsx)("div",{className:"px-4 py-2 border-t border-[var(--card-border)]",children:(0,t.jsxs)("p",{className:"text-xs text-[var(--muted)]",children:[s.length," result",1!==s.length?"s":""," found"]})})]})]})}e.s(["default",()=>a])},18929,e=>{"use strict";var t=e.i(43476),r=e.i(71645);function n({text:e}){let[n,a]=(0,r.useState)(!0),[o,s]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{s(!0),"true"===localStorage.getItem("kyr-disclaimer-dismissed")&&a(!1)},[]),o)?n?(0,t.jsx)("div",{className:"disclaimer-container fixed bottom-0 left-0 right-0 z-50 animate-slide-up",children:(0,t.jsx)("div",{className:"bg-gradient-to-r from-[var(--warning)]/10 via-[var(--warning)]/5 to-[var(--warning)]/10 border-t border-[var(--warning)]/30 backdrop-blur-sm",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-[var(--warning)]/20 flex items-center justify-center mt-0.5",children:(0,t.jsx)("svg",{className:"w-4 h-4 text-[var(--warning)]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("p",{className:"text-sm text-[var(--foreground)] leading-relaxed",children:[(0,t.jsx)("span",{className:"font-semibold text-[var(--warning)]",children:"Educational Disclaimer: "}),e]})}),(0,t.jsx)("button",{onClick:()=>{a(!1),localStorage.setItem("kyr-disclaimer-dismissed","true")},className:"flex-shrink-0 w-6 h-6 rounded-full bg-[var(--card-border)] flex items-center justify-center text-[var(--muted)] hover:text-[var(--foreground)] hover:bg-[var(--card-border)]/80 transition-colors","aria-label":"Dismiss disclaimer",children:(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})})}):(0,t.jsx)("button",{onClick:()=>{a(!0),localStorage.removeItem("kyr-disclaimer-dismissed")},className:"disclaimer-container fixed bottom-4 right-4 z-40 w-10 h-10 rounded-full bg-[var(--warning)]/20 border border-[var(--warning)]/30 flex items-center justify-center text-[var(--warning)] hover:bg-[var(--warning)]/30 transition-colors emergency-pulse","aria-label":"Show educational disclaimer",title:"Show disclaimer",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}):(0,t.jsx)("div",{className:"fixed bottom-0 left-0 right-0 z-50",children:(0,t.jsx)("div",{className:"bg-gradient-to-r from-[var(--warning)]/10 via-[var(--warning)]/5 to-[var(--warning)]/10 border-t border-[var(--warning)]/30 backdrop-blur-sm",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3",children:(0,t.jsxs)("div",{className:"flex items-start gap-3 animate-pulse",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-[var(--warning)]/20"}),(0,t.jsx)("div",{className:"flex-1 h-4 bg-[var(--warning)]/20 rounded"})]})})})})}e.s(["default",()=>n])},53431,e=>{"use strict";var t=e.i(43476),r=e.i(22016);function n(){return(0,t.jsxs)(r.default,{href:"/emergency",className:"emergency-float fixed bottom-4 left-1/2 -translate-x-1/2 sm:left-4 sm:translate-x-0 z-40 flex items-center gap-2 px-4 py-3 rounded-full bg-[var(--danger)] text-white font-medium shadow-lg shadow-[var(--danger)]/30 hover:bg-[var(--danger)]/90 hover:shadow-[var(--danger)]/50 transition-all duration-300 emergency-pulse","aria-label":"Emergency contacts and resources",children:[(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Emergency"})]})}e.s(["default",()=>n])},18566,(e,t,r)=>{t.exports=e.r(76562)},56253,e=>{"use strict";var t=e.i(43476),r=e.i(71645),n=e.i(18566);function a({children:e}){let a=(0,n.usePathname)(),[o,s]=(0,r.useState)(!1),[i,l]=(0,r.useState)(e);return(0,r.useEffect)(()=>{if(a){s(!0);let t=setTimeout(()=>{l(e),requestAnimationFrame(()=>{s(!1)})},150);return()=>clearTimeout(t)}},[a,e]),(0,t.jsx)("div",{className:`page-transition-wrapper ${o?"page-transition-exit":"page-transition-enter"}`,children:i})}e.s(["default",()=>a])},4185,e=>{"use strict";var t=e.i(43476),r=e.i(71645);function n({primary:e,secondary:n,className:a="",typingSpeedMs:o=35}){let[s,i]=(0,r.useState)(""),[l,c]=(0,r.useState)(!1),d=(0,r.useMemo)(()=>window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches??!1,[]);return(0,r.useEffect)(()=>{if(d){i(e),c(!0);return}let t=0;i(""),c(!1);let r=window.setInterval(()=>{t+=1,i(e.slice(0,t)),t>=e.length&&(window.clearInterval(r),c(!0))},o);return()=>window.clearInterval(r)},[d,e,o]),(0,t.jsxs)("h1",{className:`text-3xl sm:text-4xl md:text-5xl font-bold mb-4 leading-tight ${a}`,"aria-label":`${e} ${n}`,children:[(0,t.jsxs)("span",{className:"gradient-text inline-block",children:[(0,t.jsx)("span",{className:d?"":"typing-cursor","aria-hidden":"true",children:s}),(0,t.jsx)("span",{className:"sr-only",children:e})]}),(0,t.jsx)("br",{}),(0,t.jsx)("span",{className:`text-[var(--foreground)] inline-block ${d?"":l?"animate-text-reveal":"opacity-0"}`,children:n})]})}e.s(["default",()=>n])},96580,e=>{"use strict";var t=e.i(43476),r=e.i(71645);function n({value:e,start:n,durationMs:a=1500}){let o=(0,r.useMemo)(()=>window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches??!1,[]),[s,i]=(0,r.useState)(0);return(0,r.useEffect)(()=>{if(!n)return void i(0);if(o)return void i(e);let t=performance.now(),r=0,s=n=>{let o=Math.min(1,(n-t)/a);i(Math.round(0+(e-0)*(1-Math.pow(1-o,4)))),o<1&&(r=requestAnimationFrame(s))};return r=requestAnimationFrame(s),()=>cancelAnimationFrame(r)},[a,o,n,e]),(0,t.jsx)("span",{className:"tabular-nums",children:s})}function a({statesCount:e,scenariosCount:a}){let o=(0,r.useRef)(null),[s,i]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{if(s)return;let e=o.current;if(!e)return;let t=new IntersectionObserver(([e])=>{e.isIntersecting&&(i(!0),t.disconnect())},{threshold:.25});return t.observe(e),()=>t.disconnect()},[s]),(0,t.jsxs)("div",{ref:o,className:`mt-6 flex flex-wrap items-center justify-center gap-3 counter-animate ${s?"visible":""}`,children:[(0,t.jsxs)("div",{className:"px-4 py-2 rounded-full bg-[var(--card-bg)]/60 border border-[var(--card-border)] backdrop-blur-sm",children:[(0,t.jsx)("span",{className:"text-xs text-[var(--muted)]",children:"Coverage"}),(0,t.jsxs)("div",{className:"text-sm font-semibold text-[var(--foreground)]",children:[(0,t.jsx)(n,{value:e,start:s}),"+"," ",(0,t.jsx)("span",{className:"text-[var(--muted)] font-medium",children:"states"})]})]}),(0,t.jsxs)("div",{className:"px-4 py-2 rounded-full bg-[var(--card-bg)]/60 border border-[var(--card-border)] backdrop-blur-sm",children:[(0,t.jsx)("span",{className:"text-xs text-[var(--muted)]",children:"Practice"}),(0,t.jsxs)("div",{className:"text-sm font-semibold text-[var(--foreground)]",children:[(0,t.jsx)(n,{value:a,start:s})," ",(0,t.jsx)("span",{className:"text-[var(--muted)] font-medium",children:"scenarios"})]})]})]})}e.s(["default",()=>a])},54656,e=>{"use strict";var t=e.i(43476),r=e.i(71645),n=e.i(18566),a=e.i(44636);function o(){let[e,o]=(0,r.useState)(!1),[s,i]=(0,r.useState)(!1),{toggleTheme:l}=(0,a.useTheme)(),c=(0,n.useRouter)();(0,r.useEffect)(()=>{i(!0)},[]);let d=(0,r.useMemo)(()=>[{key:"h",description:"Home",action:()=>c.push("/")},{key:"q",description:"Quiz",action:()=>c.push("/quiz")},{key:"e",description:"Emergency",action:()=>c.push("/emergency")},{key:"t",description:"Toggle theme",action:()=>l()},{key:"?",description:"Show shortcuts",action:()=>o(!0)}],[c,l]),u=(0,r.useCallback)(e=>{if(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLSelectElement||e.target instanceof HTMLElement&&e.target.isContentEditable)return;let t=e.key.toLowerCase();if("?"===e.key){e.preventDefault(),o(!0);return}let r=d.find(e=>e.key===t);r&&"?"!==r.key&&(e.preventDefault(),r.action())},[d]);return((0,r.useEffect)(()=>{if(s)return window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)},[u,s]),(0,r.useEffect)(()=>{let t=t=>{"Escape"===t.key&&e&&o(!1)};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e]),(0,r.useEffect)(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),s&&e)?(0,t.jsxs)("div",{className:"keyboard-shortcuts-overlay fixed inset-0 z-[9999] flex items-center justify-center p-4",onClick:()=>o(!1),role:"dialog","aria-modal":"true","aria-label":"Keyboard shortcuts",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),(0,t.jsxs)("div",{className:"keyboard-shortcuts-modal relative w-full max-w-md rounded-2xl bg-[var(--card-bg)] border border-[var(--card-border)] shadow-2xl animate-fade-scale",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-[var(--card-border)]",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-xl bg-[var(--accent)]/10 flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-[var(--accent)]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-[var(--foreground)]",children:"Keyboard Shortcuts"}),(0,t.jsx)("p",{className:"text-xs text-[var(--muted)]",children:"Press a key to navigate"})]})]}),(0,t.jsx)("button",{onClick:()=>o(!1),className:"w-8 h-8 rounded-lg flex items-center justify-center text-[var(--muted)] hover:text-[var(--foreground)] hover:bg-[var(--card-border)] transition-colors","aria-label":"Close shortcuts",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("div",{className:"space-y-2",children:d.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-xl bg-[var(--background)] border border-[var(--card-border)] hover:border-[var(--accent)]/30 transition-colors",children:[(0,t.jsx)("span",{className:"text-sm text-[var(--foreground)]",children:e.description}),(0,t.jsx)("kbd",{className:"px-3 py-1.5 rounded-lg bg-[var(--card-bg)] border border-[var(--card-border)] text-sm font-mono font-semibold text-[var(--accent)] min-w-[2rem] text-center",children:e.key})]},e.key))}),(0,t.jsx)("div",{className:"mt-4 p-3 rounded-xl bg-[var(--accent)]/5 border border-[var(--accent)]/20",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)("svg",{className:"w-4 h-4 text-[var(--accent)] flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,t.jsxs)("p",{className:"text-xs text-[var(--muted)]",children:["Shortcuts are disabled when typing in input fields. Press"," ",(0,t.jsx)("kbd",{className:"px-1.5 py-0.5 rounded bg-[var(--card-bg)] border border-[var(--card-border)] text-[var(--accent)]",children:"Esc"})," ","to close this dialog."]})]})})]})]})]}):null}e.s(["default",()=>o])},98622,e=>{"use strict";var t=e.i(43476),r=e.i(71645);function n(){let[e,n]=(0,r.useState)(0),a=(0,r.useCallback)(()=>{let e=window.scrollY,t=document.documentElement.scrollHeight-window.innerHeight;n(Math.min(100,Math.max(0,t>0?e/t*100:0)))},[]);return(0,r.useEffect)(()=>{let e=null,t=!1,r=()=>{t||(t=!0,e=requestAnimationFrame(()=>{a(),t=!1}))};return a(),window.addEventListener("scroll",r,{passive:!0}),window.addEventListener("resize",a,{passive:!0}),()=>{window.removeEventListener("scroll",r),window.removeEventListener("resize",a),e&&cancelAnimationFrame(e)}},[a]),(0,t.jsx)("div",{className:"progress-bar-container no-print",children:(0,t.jsx)("div",{className:"progress-bar-fill",style:{width:`${e}%`},"aria-hidden":"true"})})}e.s(["default",()=>n])},79893,e=>{"use strict";var t=e.i(43476);function r({className:e="",label:r="Print this card"}){return(0,t.jsxs)("button",{type:"button",onClick:()=>window.print(),className:e,children:[(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),r]})}e.s(["default",()=>r])},30488,e=>{"use strict";var t=e.i(43476),r=e.i(71645);function n({text:e,className:n="",typingSpeedMs:a=18,startDelayMs:o=0,cursorClassName:s="typing-cursor"}){let[i,l]=(0,r.useState)(""),[c,d]=(0,r.useState)(!1),u=(0,r.useMemo)(()=>window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches??!1,[]);return(0,r.useEffect)(()=>{if(u)return void l(e);let t=0,r=0;return l(""),d(!1),t=window.setTimeout(()=>{d(!0);let t=0;r=window.setInterval(()=>{t+=1,l(e.slice(0,t)),t>=e.length&&window.clearInterval(r)},a)},o),()=>{window.clearTimeout(t),window.clearInterval(r)}},[u,o,e,a]),(0,t.jsxs)("span",{className:n,"aria-label":e,children:[(0,t.jsx)("span",{className:!u&&c?s:"","aria-hidden":"true",children:i}),(0,t.jsx)("span",{className:"sr-only",children:e})]})}e.s(["default",()=>n])},42895,e=>{"use strict";let t,r,n,a,o,s,i;e.s(["default",()=>E],42895);var l=e.i(43476),c=e.i(71645);e.i(2971),e.i(22016),e.i(3749);var d=e.i(53654),u=e.i(43343);e.i(5903),e.i(18929),e.i(53431),e.i(56253),e.i(4185),e.i(96580),e.i(54656),e.i(98622),e.i(79893),e.i(30488);let h=function(e,t){let r=e,n=f[t],a=null,o=0,s=null,i=[],l={},c=function(e,t){a=function(e){let t=Array(e);for(let r=0;r<e;r+=1){t[r]=Array(e);for(let n=0;n<e;n+=1)t[r][n]=null}return t}(o=4*r+17),d(0,0),d(o-7,0),d(0,o-7),g(),h(),N(e,t),r>=7&&y(e),null==s&&(s=S(r,n,i)),L(s,t)},d=function(e,t){for(let r=-1;r<=7;r+=1)if(!(e+r<=-1)&&!(o<=e+r))for(let n=-1;n<=7;n+=1)t+n<=-1||o<=t+n||(0<=r&&r<=6&&(0==n||6==n)||0<=n&&n<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=n&&n<=4?a[e+r][t+n]=!0:a[e+r][t+n]=!1)},u=function(){let e=0,t=0;for(let r=0;r<8;r+=1){c(!0,r);let n=m.getLostPoint(l);(0==r||e>n)&&(e=n,t=r)}return t},h=function(){for(let e=8;e<o-8;e+=1)null==a[e][6]&&(a[e][6]=e%2==0);for(let e=8;e<o-8;e+=1)null==a[6][e]&&(a[6][e]=e%2==0)},g=function(){let e=m.getPatternPosition(r);for(let t=0;t<e.length;t+=1)for(let r=0;r<e.length;r+=1){let n=e[t],o=e[r];if(null==a[n][o])for(let e=-2;e<=2;e+=1)for(let t=-2;t<=2;t+=1)-2==e||2==e||-2==t||2==t||0==e&&0==t?a[n+e][o+t]=!0:a[n+e][o+t]=!1}},y=function(e){let t=m.getBCHTypeNumber(r);for(let r=0;r<18;r+=1){let n=!e&&(t>>r&1)==1;a[Math.floor(r/3)][r%3+o-8-3]=n}for(let r=0;r<18;r+=1){let n=!e&&(t>>r&1)==1;a[r%3+o-8-3][Math.floor(r/3)]=n}},N=function(e,t){let r=n<<3|t,s=m.getBCHTypeInfo(r);for(let t=0;t<15;t+=1){let r=!e&&(s>>t&1)==1;t<6?a[t][8]=r:t<8?a[t+1][8]=r:a[o-15+t][8]=r}for(let t=0;t<15;t+=1){let r=!e&&(s>>t&1)==1;t<8?a[8][o-t-1]=r:t<9?a[8][15-t-1+1]=r:a[8][15-t-1]=r}a[o-8][8]=!e},L=function(e,t){let r=-1,n=o-1,s=7,i=0,l=m.getMaskFunction(t);for(let t=o-1;t>0;t-=2)for(6==t&&(t-=1);;){for(let r=0;r<2;r+=1)if(null==a[n][t-r]){let o=!1;i<e.length&&(o=(e[i]>>>s&1)==1),l(n,t-r)&&(o=!o),a[n][t-r]=o,-1==(s-=1)&&(i+=1,s=7)}if((n+=r)<0||o<=n){n-=r,r=-r;break}}},C=function(e,t){let r=0,n=0,a=0,o=Array(t.length),s=Array(t.length);for(let i=0;i<t.length;i+=1){let l=t[i].dataCount,c=t[i].totalCount-l;n=Math.max(n,l),a=Math.max(a,c),o[i]=Array(l);for(let t=0;t<o[i].length;t+=1)o[i][t]=255&e.getBuffer()[t+r];r+=l;let d=m.getErrorCorrectPolynomial(c),u=x(o[i],d.getLength()-1).mod(d);s[i]=Array(d.getLength()-1);for(let e=0;e<s[i].length;e+=1){let t=e+u.getLength()-s[i].length;s[i][e]=t>=0?u.getAt(t):0}}let i=0;for(let e=0;e<t.length;e+=1)i+=t[e].totalCount;let l=Array(i),c=0;for(let e=0;e<n;e+=1)for(let r=0;r<t.length;r+=1)e<o[r].length&&(l[c]=o[r][e],c+=1);for(let e=0;e<a;e+=1)for(let r=0;r<t.length;r+=1)e<s[r].length&&(l[c]=s[r][e],c+=1);return l},S=function(e,t,r){let n=v.getRSBlocks(e,t),a=p();for(let t=0;t<r.length;t+=1){let n=r[t];a.put(n.getMode(),4),a.put(n.getLength(),m.getLengthInBits(n.getMode(),e)),n.write(a)}let o=0;for(let e=0;e<n.length;e+=1)o+=n[e].dataCount;if(a.getLengthInBits()>8*o)throw"code length overflow. ("+a.getLengthInBits()+">"+8*o+")";for(a.getLengthInBits()+4<=8*o&&a.put(0,4);a.getLengthInBits()%8!=0;)a.putBit(!1);for(;!(a.getLengthInBits()>=8*o)&&(a.put(236,8),!(a.getLengthInBits()>=8*o));){;a.put(17,8)}return C(a,n)};l.addData=function(e,t){let r=null;switch(t=t||"Byte"){case"Numeric":r=w(e);break;case"Alphanumeric":r=b(e);break;case"Byte":r=j(e);break;case"Kanji":r=k(e);break;default:throw"mode:"+t}i.push(r),s=null},l.isDark=function(e,t){if(e<0||o<=e||t<0||o<=t)throw e+","+t;return a[e][t]},l.getModuleCount=function(){return o},l.make=function(){if(r<1){let e=1;for(;e<40;e++){let t=v.getRSBlocks(e,n),r=p();for(let t=0;t<i.length;t++){let n=i[t];r.put(n.getMode(),4),r.put(n.getLength(),m.getLengthInBits(n.getMode(),e)),n.write(r)}let a=0;for(let e=0;e<t.length;e++)a+=t[e].dataCount;if(r.getLengthInBits()<=8*a)break}r=e}c(!1,u())},l.createTableTag=function(e,t){e=e||2;let r="";r+='<table style=" border-width: 0px; border-style: none; border-collapse: collapse; padding: 0px; margin: '+(t=void 0===t?4*e:t)+'px;"><tbody>';for(let t=0;t<l.getModuleCount();t+=1){r+="<tr>";for(let n=0;n<l.getModuleCount();n+=1)r+='<td style=" border-width: 0px; border-style: none; border-collapse: collapse; padding: 0px; margin: 0px; width: '+e+"px;"+(" height: "+e)+"px; background-color: "+(l.isDark(t,n)?"#000000":"#ffffff")+';"/>';r+="</tr>"}return r+"</tbody></table>"},l.createSvgTag=function(e,t,r,n){let a={};"object"==typeof arguments[0]&&(a=arguments[0],e=a.cellSize,t=a.margin,r=a.alt,n=a.title),e=e||2,t=void 0===t?4*e:t,(r="string"==typeof r?{text:r}:r||{}).text=r.text||null,r.id=r.text?r.id||"qrcode-description":null,(n="string"==typeof n?{text:n}:n||{}).text=n.text||null,n.id=n.text?n.id||"qrcode-title":null;let o=l.getModuleCount()*e+2*t,s,i,c,d="",u;for(u="l"+e+",0 0,"+e+" -"+e+",0 0,-"+e+"z ",d+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',d+=a.scalable?"":' width="'+o+'px" height="'+o+'px"',d+=' viewBox="0 0 '+o+" "+o+'" ',d+=' preserveAspectRatio="xMinYMin meet"',d+=n.text||r.text?' role="img" aria-labelledby="'+B([n.id,r.id].join(" ").trim())+'"':"",d+=">",d+=n.text?'<title id="'+B(n.id)+'">'+B(n.text)+"</title>":"",d+=r.text?'<description id="'+B(r.id)+'">'+B(r.text)+"</description>":"",d+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',d+='<path d="',i=0;i<l.getModuleCount();i+=1)for(s=0,c=i*e+t;s<l.getModuleCount();s+=1)l.isDark(i,s)&&(d+="M"+(s*e+t)+","+c+u);return d+='" stroke="transparent" fill="black"/>',d+="</svg>"},l.createDataURL=function(e,t){e=e||2,t=void 0===t?4*e:t;let r=l.getModuleCount()*e+2*t,n=t,a=r-t;return M(r,r,function(t,r){if(!(n<=t)||!(t<a)||!(n<=r)||!(r<a))return 1;{let a=Math.floor((t-n)/e),o=Math.floor((r-n)/e);return+!l.isDark(o,a)}})},l.createImgTag=function(e,t,r){e=e||2,t=void 0===t?4*e:t;let n=l.getModuleCount()*e+2*t,a="";return a+="<img",a+=' src="',a+=l.createDataURL(e,t),a+='"',a+=' width="',a+=n,a+='"',a+=' height="',a+=n,a+='"',r&&(a+=' alt="',a+=B(r),a+='"'),a+="/>"};let B=function(e){let t="";for(let r=0;r<e.length;r+=1){let n=e.charAt(r);switch(n){case"<":t+="&lt;";break;case">":t+="&gt;";break;case"&":t+="&amp;";break;case'"':t+="&quot;";break;default:t+=n}}return t},E=function(e){let t,r,n,a,o;e=void 0===e?2:e;let s=+l.getModuleCount()+2*e,i=e,c=s-e,d={"██":"█","█ ":"▀"," █":"▄","  ":" "},u={"██":"▀","█ ":"▀"," █":" ","  ":" "},h="";for(t=0;t<s;t+=2){for(r=0,n=Math.floor((t-i)/1),a=Math.floor((t+1-i)/1);r<s;r+=1)o="█",i<=r&&r<c&&i<=t&&t<c&&l.isDark(n,Math.floor((r-i)/1))&&(o=" "),i<=r&&r<c&&i<=t+1&&t+1<c&&l.isDark(a,Math.floor((r-i)/1))?o+=" ":o+="█",h+=e<1&&t+1>=c?u[o]:d[o];h+="\n"}return s%2&&e>0?h.substring(0,h.length-s-1)+Array(s+1).join("▀"):h.substring(0,h.length-1)};return l.createASCII=function(e,t){let r,n,a,o;if((e=e||1)<2)return E(t);e-=1,t=void 0===t?2*e:t;let s=l.getModuleCount()*e+2*t,i=t,c=s-t,d=Array(e+1).join("██"),u=Array(e+1).join("  "),h="",f="";for(r=0;r<s;r+=1){for(n=0,a=Math.floor((r-i)/e),f="";n<s;n+=1)o=1,i<=n&&n<c&&i<=r&&r<c&&l.isDark(a,Math.floor((n-i)/e))&&(o=0),f+=o?d:u;for(a=0;a<e;a+=1)h+=f+"\n"}return h.substring(0,h.length-1)},l.renderTo2dContext=function(e,t){t=t||2;let r=l.getModuleCount();for(let n=0;n<r;n++)for(let a=0;a<r;a++)e.fillStyle=l.isDark(n,a)?"black":"white",e.fillRect(a*t,n*t,t,t)},l};h.stringToBytes=function(e){let t=[];for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);t.push(255&n)}return t},h.createStringToBytes=function(e,t){let r=function(){let r=L(e),n=function(){let e=r.read();if(-1==e)throw"eof";return e},a=0,o={};for(;;){let e=r.read();if(-1==e)break;let t=n(),s=n(),i=n(),l=String.fromCharCode(e<<8|t),c=s<<8|i;o[l]=c,a+=1}if(a!=t)throw a+" != "+t;return o}();return function(e){let t=[];for(let n=0;n<e.length;n+=1){let a=e.charCodeAt(n);if(a<128)t.push(a);else{let a=r[e.charAt(n)];"number"==typeof a?(255&a)==a?t.push(a):(t.push(a>>>8),t.push(255&a)):t.push(63)}}return t}};let f={L:1,M:0,Q:3,H:2},m=(t=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],r={},n=function(e){let t=0;for(;0!=e;)t+=1,e>>>=1;return t},r.getBCHTypeInfo=function(e){let t=e<<10;for(;n(t)-n(1335)>=0;)t^=1335<<n(t)-n(1335);return(e<<10|t)^21522},r.getBCHTypeNumber=function(e){let t=e<<12;for(;n(t)-n(7973)>=0;)t^=7973<<n(t)-n(7973);return e<<12|t},r.getPatternPosition=function(e){return t[e-1]},r.getMaskFunction=function(e){switch(e){case 0:return function(e,t){return(e+t)%2==0};case 1:return function(e,t){return e%2==0};case 2:return function(e,t){return t%3==0};case 3:return function(e,t){return(e+t)%3==0};case 4:return function(e,t){return(Math.floor(e/2)+Math.floor(t/3))%2==0};case 5:return function(e,t){return e*t%2+e*t%3==0};case 6:return function(e,t){return(e*t%2+e*t%3)%2==0};case 7:return function(e,t){return(e*t%3+(e+t)%2)%2==0};default:throw"bad maskPattern:"+e}},r.getErrorCorrectPolynomial=function(e){let t=x([1],0);for(let r=0;r<e;r+=1)t=t.multiply(x([1,g.gexp(r)],0));return t},r.getLengthInBits=function(e,t){if(1<=t&&t<10)switch(e){case 1:return 10;case 2:return 9;case 4:case 8:return 8;default:throw"mode:"+e}if(t<27)switch(e){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw"mode:"+e}if(t<41)switch(e){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw"mode:"+e}throw"type:"+t},r.getLostPoint=function(e){let t=e.getModuleCount(),r=0;for(let n=0;n<t;n+=1)for(let a=0;a<t;a+=1){let o=0,s=e.isDark(n,a);for(let r=-1;r<=1;r+=1)if(!(n+r<0)&&!(t<=n+r))for(let i=-1;i<=1;i+=1)a+i<0||t<=a+i||(0!=r||0!=i)&&s==e.isDark(n+r,a+i)&&(o+=1);o>5&&(r+=3+o-5)}for(let n=0;n<t-1;n+=1)for(let a=0;a<t-1;a+=1){let t=0;e.isDark(n,a)&&(t+=1),e.isDark(n+1,a)&&(t+=1),e.isDark(n,a+1)&&(t+=1),e.isDark(n+1,a+1)&&(t+=1),(0==t||4==t)&&(r+=3)}for(let n=0;n<t;n+=1)for(let a=0;a<t-6;a+=1)e.isDark(n,a)&&!e.isDark(n,a+1)&&e.isDark(n,a+2)&&e.isDark(n,a+3)&&e.isDark(n,a+4)&&!e.isDark(n,a+5)&&e.isDark(n,a+6)&&(r+=40);for(let n=0;n<t;n+=1)for(let a=0;a<t-6;a+=1)e.isDark(a,n)&&!e.isDark(a+1,n)&&e.isDark(a+2,n)&&e.isDark(a+3,n)&&e.isDark(a+4,n)&&!e.isDark(a+5,n)&&e.isDark(a+6,n)&&(r+=40);let n=0;for(let r=0;r<t;r+=1)for(let a=0;a<t;a+=1)e.isDark(a,r)&&(n+=1);return r+10*(Math.abs(100*n/t/t-50)/5)},r),g=function(){let e=Array(256),t=Array(256);for(let t=0;t<8;t+=1)e[t]=1<<t;for(let t=8;t<256;t+=1)e[t]=e[t-4]^e[t-5]^e[t-6]^e[t-8];for(let r=0;r<255;r+=1)t[e[r]]=r;let r={};return r.glog=function(e){if(e<1)throw"glog("+e+")";return t[e]},r.gexp=function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return e[t]},r}(),x=function(e,t){if(void 0===e.length)throw e.length+"/"+t;let r=function(){let r=0;for(;r<e.length&&0==e[r];)r+=1;let n=Array(e.length-r+t);for(let t=0;t<e.length-r;t+=1)n[t]=e[t+r];return n}(),n={};return n.getAt=function(e){return r[e]},n.getLength=function(){return r.length},n.multiply=function(e){let t=Array(n.getLength()+e.getLength()-1);for(let r=0;r<n.getLength();r+=1)for(let a=0;a<e.getLength();a+=1)t[r+a]^=g.gexp(g.glog(n.getAt(r))+g.glog(e.getAt(a)));return x(t,0)},n.mod=function(e){if(n.getLength()-e.getLength()<0)return n;let t=g.glog(n.getAt(0))-g.glog(e.getAt(0)),r=Array(n.getLength());for(let e=0;e<n.getLength();e+=1)r[e]=n.getAt(e);for(let n=0;n<e.getLength();n+=1)r[n]^=g.gexp(g.glog(e.getAt(n))+t);return x(r,0).mod(e)},n},v=(a=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],o=function(e,t){let r={};return r.totalCount=e,r.dataCount=t,r},s={},i=function(e,t){switch(t){case f.L:return a[(e-1)*4+0];case f.M:return a[(e-1)*4+1];case f.Q:return a[(e-1)*4+2];case f.H:return a[(e-1)*4+3];default:return}},s.getRSBlocks=function(e,t){let r=i(e,t);if(void 0===r)throw"bad rs block @ typeNumber:"+e+"/errorCorrectionLevel:"+t;let n=r.length/3,a=[];for(let e=0;e<n;e+=1){let t=r[3*e+0],n=r[3*e+1],s=r[3*e+2];for(let e=0;e<t;e+=1)a.push(o(n,s))}return a},s),p=function(){let e=[],t=0,r={};return r.getBuffer=function(){return e},r.getAt=function(t){return(e[Math.floor(t/8)]>>>7-t%8&1)==1},r.put=function(e,t){for(let n=0;n<t;n+=1)r.putBit((e>>>t-n-1&1)==1)},r.getLengthInBits=function(){return t},r.putBit=function(r){let n=Math.floor(t/8);e.length<=n&&e.push(0),r&&(e[n]|=128>>>t%8),t+=1},r},w=function(e){let t={};t.getMode=function(){return 1},t.getLength=function(t){return e.length},t.write=function(t){let n=0;for(;n+2<e.length;)t.put(r(e.substring(n,n+3)),10),n+=3;n<e.length&&(e.length-n==1?t.put(r(e.substring(n,n+1)),4):e.length-n==2&&t.put(r(e.substring(n,n+2)),7))};let r=function(e){let t=0;for(let r=0;r<e.length;r+=1)t=10*t+n(e.charAt(r));return t},n=function(e){if("0"<=e&&e<="9")return e.charCodeAt(0)-48;throw"illegal char :"+e};return t},b=function(e){let t={};t.getMode=function(){return 2},t.getLength=function(t){return e.length},t.write=function(t){let n=0;for(;n+1<e.length;)t.put(45*r(e.charAt(n))+r(e.charAt(n+1)),11),n+=2;n<e.length&&t.put(r(e.charAt(n)),6)};let r=function(e){if("0"<=e&&e<="9")return e.charCodeAt(0)-48;if("A"<=e&&e<="Z")return e.charCodeAt(0)-65+10;switch(e){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+e}};return t},j=function(e){let t=h.stringToBytes(e),r={};return r.getMode=function(){return 4},r.getLength=function(e){return t.length},r.write=function(e){for(let r=0;r<t.length;r+=1)e.put(t[r],8)},r},k=function(e){let t=h.stringToBytes,r=t("友");if(2!=r.length||(r[0]<<8|r[1])!=38726)throw"sjis not supported.";let n=t(e),a={};return a.getMode=function(){return 8},a.getLength=function(e){return~~(n.length/2)},a.write=function(e){let t=0;for(;t+1<n.length;){let r=(255&n[t])<<8|255&n[t+1];if(33088<=r&&r<=40956)r-=33088;else if(57408<=r&&r<=60351)r-=49472;else throw"illegal char at "+(t+1)+"/"+r;r=(r>>>8&255)*192+(255&r),e.put(r,13),t+=2}if(t<n.length)throw"illegal char at "+(t+1)},a},y=function(){let e=[],t={};return t.writeByte=function(t){e.push(255&t)},t.writeShort=function(e){t.writeByte(e),t.writeByte(e>>>8)},t.writeBytes=function(e,r,n){r=r||0,n=n||e.length;for(let a=0;a<n;a+=1)t.writeByte(e[a+r])},t.writeString=function(e){for(let r=0;r<e.length;r+=1)t.writeByte(e.charCodeAt(r))},t.toByteArray=function(){return e},t.toString=function(){let t="";t+="[";for(let r=0;r<e.length;r+=1)r>0&&(t+=","),t+=e[r];return t+"]"},t},N=function(){let e=0,t=0,r=0,n="",a={},o=function(e){n+=String.fromCharCode(s(63&e))},s=function(e){if(e<0)throw"n:"+e;if(e<26)return 65+e;if(e<52)return 97+(e-26);if(e<62)return 48+(e-52);if(62==e)return 43;else if(63==e)return 47;else throw"n:"+e};return a.writeByte=function(n){for(e=e<<8|255&n,t+=8,r+=1;t>=6;)o(e>>>t-6),t-=6},a.flush=function(){if(t>0&&(o(e<<6-t),e=0,t=0),r%3!=0){let e=3-r%3;for(let t=0;t<e;t+=1)n+="="}},a.toString=function(){return n},a},L=function(e){let t=0,r=0,n=0,a={};a.read=function(){for(;n<8;){if(t>=e.length){if(0==n)return -1;throw"unexpected end of file./"+n}let a=e.charAt(t);if(t+=1,"="==a)return n=0,-1;a.match(/^\s$/)||(r=r<<6|o(a.charCodeAt(0)),n+=6)}let a=r>>>n-8&255;return n-=8,a};let o=function(e){if(65<=e&&e<=90)return e-65;if(97<=e&&e<=122)return e-97+26;if(48<=e&&e<=57)return e-48+52;if(43==e)return 62;if(47==e)return 63;else throw"c:"+e};return a},C=function(e,t){let r=Array(e*t),n={};n.setPixel=function(t,n,a){r[n*e+t]=a},n.write=function(r){r.writeString("GIF87a"),r.writeShort(e),r.writeShort(t),r.writeByte(128),r.writeByte(0),r.writeByte(0),r.writeByte(0),r.writeByte(0),r.writeByte(0),r.writeByte(255),r.writeByte(255),r.writeByte(255),r.writeString(","),r.writeShort(0),r.writeShort(0),r.writeShort(e),r.writeShort(t),r.writeByte(0);let n=o(2);r.writeByte(2);let a=0;for(;n.length-a>255;)r.writeByte(255),r.writeBytes(n,a,255),a+=255;r.writeByte(n.length-a),r.writeBytes(n,a,n.length-a),r.writeByte(0),r.writeString(";")};let a=function(e){let t=0,r=0,n={};return n.write=function(n,a){if(n>>>a!=0)throw"length over";for(;t+a>=8;)e.writeByte(255&(n<<t|r)),a-=8-t,n>>>=8-t,r=0,t=0;r=n<<t|r,t+=a},n.flush=function(){t>0&&e.writeByte(r)},n},o=function(e){let t=1<<e,n=(1<<e)+1,o=e+1,i=s();for(let e=0;e<t;e+=1)i.add(String.fromCharCode(e));i.add(String.fromCharCode(t)),i.add(String.fromCharCode(n));let l=y(),c=a(l);c.write(t,o);let d=0,u=String.fromCharCode(r[0]);for(d+=1;d<r.length;){let e=String.fromCharCode(r[d]);d+=1,i.contains(u+e)?u+=e:(c.write(i.indexOf(u),o),4095>i.size()&&(i.size()==1<<o&&(o+=1),i.add(u+e)),u=e)}return c.write(i.indexOf(u),o),c.write(n,o),c.flush(),l.toByteArray()},s=function(){let e={},t=0,r={};return r.add=function(n){if(r.contains(n))throw"dup key:"+n;e[n]=t,t+=1},r.size=function(){return t},r.indexOf=function(t){return e[t]},r.contains=function(t){return void 0!==e[t]},r};return n},M=function(e,t,r){let n=C(e,t);for(let a=0;a<t;a+=1)for(let t=0;t<e;t+=1)n.setPixel(t,a,r(t,a));let a=y();n.write(a);let o=N(),s=a.toByteArray();for(let e=0;e<s.length;e+=1)o.writeByte(s[e]);return o.flush(),"data:image/gif;base64,"+o};h.stringToBytes;async function S(e){if(navigator.clipboard?.writeText)return void await navigator.clipboard.writeText(e);let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.top="-9999px",t.style.left="-9999px",document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),document.body.removeChild(t)}function B({phrases:e}){let[t,r]=(0,c.useState)(null),n=(0,c.useRef)(null);(0,c.useEffect)(()=>()=>{n.current&&window.clearTimeout(n.current)},[]);let a=(0,c.useCallback)(async e=>{try{await S(e),r("Copied!"),n.current&&window.clearTimeout(n.current),n.current=window.setTimeout(()=>r(null),1200)}catch{r("Could not copy"),n.current&&window.clearTimeout(n.current),n.current=window.setTimeout(()=>r(null),1600)}},[]);return e.length?(0,l.jsxs)("div",{className:"mt-10",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,l.jsx)("div",{className:"w-10 h-10 rounded-xl bg-[var(--accent)]/10 flex items-center justify-center",children:(0,l.jsx)("svg",{className:"w-5 h-5 text-[var(--accent)]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-lg font-bold text-[var(--foreground)]",children:"What to Say"}),(0,l.jsx)("p",{className:"text-sm text-[var(--muted)]",children:"Click a phrase to copy."})]})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:e.map(e=>(0,l.jsxs)("button",{type:"button",onClick:()=>a(e),className:"inline-flex items-center gap-2 px-3 py-2 rounded-full text-sm bg-[var(--card-bg)] border border-[var(--card-border)] text-[var(--foreground)] hover:border-[var(--accent)]/60 hover:bg-[var(--accent)]/5 transition-colors","aria-label":`Copy phrase: ${e}`,children:[(0,l.jsx)("span",{className:"text-[var(--accent)]",children:"❝"}),(0,l.jsx)("span",{className:"whitespace-nowrap",children:e}),(0,l.jsx)("span",{className:"text-[var(--accent)]",children:"❞"})]},e))}),(0,l.jsx)("div",{className:"aria-live-region","aria-live":"polite","aria-atomic":"true",children:t??""}),t&&(0,l.jsx)("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 z-[60] px-4 py-2 rounded-full bg-black/70 text-white text-sm shadow-lg no-print",children:t})]}):null}function E({scenario:e,availableStates:t}){let[r,n]=(0,c.useState)(""),[a,o]=(0,c.useState)(!1),s=(0,c.useRef)(null),i=(0,c.useMemo)(()=>e.phrases??[],[e.phrases]),h=function(e){let[t,r]=(0,c.useState)(0),n=(0,c.useCallback)(()=>{let t=e.current;if(!t)return;let n=window.scrollY,a=t.getBoundingClientRect().top+n,o=t.offsetHeight-window.innerHeight;o<=0?r(100*(n>=a)):r(Math.min(100,Math.max(0,(n-a)/o*100)))},[e]);return(0,c.useEffect)(()=>{let e=0,t=!1,r=()=>{t||(t=!0,e=window.requestAnimationFrame(()=>{n(),t=!1}))};return n(),window.addEventListener("scroll",r,{passive:!0}),window.addEventListener("resize",n,{passive:!0}),()=>{window.removeEventListener("scroll",r),window.removeEventListener("resize",n),window.cancelAnimationFrame(e)}},[n]),t}(s);return((0,c.useEffect)(()=>{o(!0);let r=JSON.parse(localStorage.getItem("kyr-viewed-scenarios")||"[]");r.includes(e.id)||(r.push(e.id),localStorage.setItem("kyr-viewed-scenarios",JSON.stringify(r)),window.dispatchEvent(new Event("kyr-progress-update")));let a=new URLSearchParams(window.location.search).get("state");a&&t.includes(a)&&n(a)},[t,e.id]),a)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"reading-progress-container no-print","aria-hidden":"true",children:(0,l.jsx)("div",{className:"reading-progress-fill",style:{width:`${h}%`}})}),(0,l.jsxs)("div",{ref:s,children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-[var(--foreground)] mb-1",children:"Your Rights"}),(0,l.jsxs)("p",{className:"text-sm text-[var(--muted)]",children:[e.rights.length," rights in this scenario"]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsxs)("button",{onClick:()=>{let e=new CustomEvent("kyr-expand-all");window.dispatchEvent(e),setTimeout(()=>{window.print()},300)},className:"flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-medium bg-[var(--card-bg)] text-[var(--foreground)] border border-[var(--card-border)] hover:border-[var(--accent)]/50 hover:bg-[var(--accent)]/5 transition-all duration-200 no-print","aria-label":"Print this page",type:"button",children:[(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print"]}),(0,l.jsx)(u.default,{selectedState:r,onStateChange:t=>{n(t);let r=t?`/scenario/${e.id}/?state=${t}`:`/scenario/${e.id}/`;window.history.replaceState({},"",r)},availableStates:t})]})]}),r&&(0,l.jsx)("div",{className:"mb-6 p-4 rounded-xl bg-[var(--success)]/10 border border-[var(--success)]/20 animate-fade-in no-print",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-8 h-8 rounded-lg bg-[var(--success)]/20 flex items-center justify-center",children:(0,l.jsxs)("svg",{className:"w-4 h-4 text-[var(--success)]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),(0,l.jsxs)("p",{className:"text-sm text-[var(--foreground)]",children:["Showing ",(0,l.jsx)("span",{className:"font-semibold text-[var(--success)]",children:r}),"-specific information where available."]})]})}),(0,l.jsx)("div",{className:"space-y-4",children:e.rights.map((t,n)=>(0,l.jsx)(d.default,{right:t,index:n,selectedState:r,scenarioId:e.id},t.title))}),(0,l.jsx)(B,{phrases:i})]})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-[var(--foreground)] mb-1",children:"Your Rights"}),(0,l.jsxs)("p",{className:"text-sm text-[var(--muted)]",children:[e.rights.length," rights in this scenario"]})]}),(0,l.jsx)("div",{className:"h-10 w-32 bg-[var(--card-bg)] rounded-xl animate-pulse"})]}),(0,l.jsx)("div",{className:"space-y-4",children:e.rights.map((t,r)=>(0,l.jsx)(d.default,{right:t,index:r,selectedState:"",scenarioId:e.id},t.title))})]})}}]);